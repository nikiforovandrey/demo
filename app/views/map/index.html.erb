<!DOCTYPE html>
<html>
<head>
<script src="http://maps.googleapis.com/maps/api/js"></script>
<script>
	var map;
	var latx = 24.149126;
	var laty = 120.684920;
	var myCenter = new google.maps.LatLng(latx,laty);

	function initialize(){

		var mapProp = {
  			center:myCenter,
  			disableDefaultUI:true,  
  			zoom:15,
  			mapTypeId:google.maps.MapTypeId.ROADMAP
  		};

		map = new google.maps.Map(document.getElementById("googleMap"),mapProp);
		
		setmapmark();
	}

	function setmapmark(){

		var mapj = JSON.parse('<%= @map.to_json.html_safe %>');
		for (var i = 0; i < mapj.length; i++) {
			var newpoint = new google.maps.LatLng(mapj[i].latx,mapj[i].laty);

			var marker=new google.maps.Marker({
				position:newpoint,
				map:map
			});
		};
	}


	google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>

<body>

<div id="googleMap" style="width:600px;height:600px;"></div>
<button id="btosetmap">direct to set mark</button>

</body>
</html>